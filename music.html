<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <title>üé∂ –ú—É–∑—ã–∫–∞–ª—å–Ω–æ–µ —Ä–∞–¥–∏–æ</title>
    <style>
      body { font-family: Arial, text-align: center; margin-top: 50px; }
      #info { font-size: 18px; margin: 10px 0; }
      button { background: #4CAF50; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; }
    </style>
  </head>
  <body>
    <h1>üé∂ –°–ª—É—á–∞–π–Ω–æ–µ —Ä–∞–¥–∏–æ</h1>
    <p id="info">–ù–∞–∂–º–∏—Ç–µ "–û–±–Ω–æ–≤–∏—Ç—å"</p>
    <audio id="player" controls></audio>
    <button onclick="playRandomSong()">üîÄ –ù–æ–≤—ã–π —Ç—Ä–µ–∫</button>

    <script>
      const player = document.getElementById("player");

      async function playRandomSong() {
        try {
          const response = await fetch("/api/random-song");
          const song = await response.json();

          document.getElementById("info").textContent = song.title;
          player.src = song.url; // /api/music/track.mp3
          player.play().catch((e) => console.log("Autoplay blocked:", e));
        } catch (error) {
          console.error("–û—à–∏–±–∫–∞:", error);
          document.getElementById("info").textContent = "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏";
        }
      }

      // –ê–≤—Ç–æ–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —Ç—Ä–µ–∫
      player.addEventListener("ended", playRandomSong);
    </script>
  </body>
</html>
